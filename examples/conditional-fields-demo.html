<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>条件字段和表单分组演示 - @ldesign/form</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    :root {
      --ldesign-brand-color: #722ED1;
      --ldesign-success-color: #52c41a;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      padding: 20px;
      background: #f5f5f5;
    }

    .container {
      max-width: 900px;
      margin: 0 auto;
    }

    .page-header {
      background: #fff;
      padding: 24px;
      border-radius: 4px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      margin-bottom: 24px;
    }

    .page-header h1 {
      font-size: 24px;
      color: var(--ldesign-brand-color);
      margin-bottom: 8px;
    }

    .form-container {
      background: #fff;
      border-radius: 4px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      margin-bottom: 24px;
    }

    .form-group {
      border-bottom: 1px solid #f0f0f0;
    }

    .form-group:last-child {
      border-bottom: none;
    }

    .form-group-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 20px 24px;
      background: #fafafa;
      cursor: pointer;
      user-select: none;
      transition: all 0.3s;
    }

    .form-group-header:hover {
      background: #f5f5f5;
    }

    .form-group-title {
      display: flex;
      align-items: center;
      gap: 12px;
      font-size: 16px;
      font-weight: 600;
      color: rgba(0, 0, 0, 0.85);
    }

    .form-group-icon {
      font-size: 20px;
    }

    .form-group-arrow {
      font-size: 14px;
      color: rgba(0, 0, 0, 0.45);
      transition: transform 0.3s;
    }

    .form-group.expanded .form-group-arrow {
      transform: rotate(90deg);
    }

    .form-group-body {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.3s ease-out;
    }

    .form-group.expanded .form-group-body {
      max-height: 2000px;
    }

    .form-group-content {
      padding: 24px;
    }

    .form-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
    }

    .form-item {
      margin-bottom: 16px;
    }

    .form-label {
      display: block;
      margin-bottom: 8px;
      font-size: 14px;
      font-weight: 500;
      color: rgba(0, 0, 0, 0.85);
    }

    .form-input,
    .form-select {
      width: 100%;
      padding: 8px 12px;
      font-size: 14px;
      border: 1px solid #d9d9d9;
      border-radius: 4px;
      outline: none;
      transition: all 0.3s;
    }

    .form-input:focus,
    .form-select:focus {
      border-color: var(--ldesign-brand-color);
      box-shadow: 0 0 0 2px rgba(114, 46, 209, 0.1);
    }

    .switch-field {
      display: inline-flex;
      align-items: center;
      gap: 12px;
    }

    .switch {
      position: relative;
      display: inline-block;
      width: 44px;
      height: 22px;
      background: rgba(0, 0, 0, 0.25);
      border-radius: 11px;
      cursor: pointer;
      transition: all 0.3s;
    }

    .switch.checked {
      background: var(--ldesign-brand-color);
    }

    .switch-handle {
      position: absolute;
      top: 2px;
      left: 2px;
      width: 18px;
      height: 18px;
      background: #fff;
      border-radius: 50%;
      transition: all 0.3s;
    }

    .switch.checked .switch-handle {
      left: 22px;
    }

    .conditional-field {
      animation: fadeIn 0.3s ease;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .btn {
      padding: 8px 16px;
      font-size: 14px;
      border: 1px solid #d9d9d9;
      border-radius: 4px;
      background: #fff;
      cursor: pointer;
      transition: all 0.3s;
    }

    .btn-primary {
      background: var(--ldesign-brand-color);
      border-color: var(--ldesign-brand-color);
      color: #fff;
    }

    .btn-primary:hover {
      background: #5c24a8;
    }

    .form-actions {
      display: flex;
      gap: 12px;
      padding: 24px;
      background: #fafafa;
    }
  </style>
</head>

<body>
  <div class="container">
    <!-- 页面头部 -->
    <div class="page-header">
      <h1>🎯 条件字段和表单分组演示</h1>
      <p>展示根据字段值动态显示/隐藏字段，以及表单分组折叠展开功能</p>
    </div>

    <!-- 表单 -->
    <div class="form-container">
      <!-- 基本信息组 -->
      <div class="form-group expanded" id="group-basic">
        <div class="form-group-header" onclick="toggleGroup('basic')">
          <div class="form-group-title">
            <span class="form-group-icon">👤</span>
            <span>基本信息</span>
          </div>
          <span class="form-group-arrow">▶</span>
        </div>
        <div class="form-group-body">
          <div class="form-group-content">
            <div class="form-grid">
              <div class="form-item">
                <label class="form-label">用户名</label>
                <input type="text" id="username" class="form-input" placeholder="请输入用户名" />
              </div>

              <div class="form-item">
                <label class="form-label">邮箱</label>
                <input type="email" id="email" class="form-input" placeholder="请输入邮箱" />
              </div>

              <div class="form-item">
                <label class="form-label">性别</label>
                <select id="gender" class="form-select">
                  <option value="">请选择</option>
                  <option value="male">男</option>
                  <option value="female">女</option>
                  <option value="other">其他</option>
                </select>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- 工作信息组（条件显示） -->
      <div class="form-group expanded" id="group-work">
        <div class="form-group-header" onclick="toggleGroup('work')">
          <div class="form-group-title">
            <span class="form-group-icon">💼</span>
            <span>工作信息</span>
          </div>
          <span class="form-group-arrow">▶</span>
        </div>
        <div class="form-group-body">
          <div class="form-group-content">
            <div class="form-item" style="margin-bottom: 20px;">
              <div class="switch-field">
                <div id="hasJobSwitch" class="switch">
                  <div class="switch-handle"></div>
                </div>
                <label class="form-label" style="margin: 0;">是否有工作</label>
              </div>
            </div>

            <!-- 条件显示的字段 -->
            <div id="jobFields" style="display: none;">
              <div class="conditional-field">
                <div class="form-grid">
                  <div class="form-item">
                    <label class="form-label">公司名称</label>
                    <input type="text" id="company" class="form-input" placeholder="请输入公司名称" />
                  </div>

                  <div class="form-item">
                    <label class="form-label">职位</label>
                    <input type="text" id="position" class="form-input" placeholder="请输入职位" />
                  </div>

                  <div class="form-item">
                    <label class="form-label">行业</label>
                    <select id="industry" class="form-select">
                      <option value="">请选择</option>
                      <option value="it">互联网</option>
                      <option value="finance">金融</option>
                      <option value="education">教育</option>
                      <option value="other">其他</option>
                    </select>
                  </div>

                  <!-- 其他行业（二级条件显示） -->
                  <div class="form-item" id="otherIndustryField" style="display: none;">
                    <label class="form-label">请说明行业</label>
                    <input type="text" id="otherIndustry" class="form-input" placeholder="请输入具体行业" />
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- 配送信息组（条件显示） -->
      <div class="form-group expanded" id="group-shipping">
        <div class="form-group-header" onclick="toggleGroup('shipping')">
          <div class="form-group-title">
            <span class="form-group-icon">🚚</span>
            <span>配送信息</span>
          </div>
          <span class="form-group-arrow">▶</span>
        </div>
        <div class="form-group-body">
          <div class="form-group-content">
            <div class="form-item">
              <label class="form-label">配送方式</label>
              <select id="shippingMethod" class="form-select">
                <option value="">请选择</option>
                <option value="express">快递配送</option>
                <option value="pickup">门店自提</option>
              </select>
            </div>

            <!-- 快递配送相关字段 -->
            <div id="expressFields" style="display: none;">
              <div class="conditional-field">
                <div class="form-grid">
                  <div class="form-item">
                    <label class="form-label">收货人</label>
                    <input type="text" id="receiverName" class="form-input" placeholder="请输入收货人姓名" />
                  </div>

                  <div class="form-item">
                    <label class="form-label">联系电话</label>
                    <input type="tel" id="receiverPhone" class="form-input" placeholder="请输入联系电话" />
                  </div>

                  <div class="form-item" style="grid-column: 1 / -1;">
                    <label class="form-label">收货地址</label>
                    <input type="text" id="receiverAddress" class="form-input" placeholder="请输入详细地址" />
                  </div>
                </div>
              </div>
            </div>

            <!-- 门店自提相关字段 -->
            <div id="pickupFields" style="display: none;">
              <div class="conditional-field">
                <div class="form-grid">
                  <div class="form-item">
                    <label class="form-label">自提门店</label>
                    <select id="pickupStore" class="form-select">
                      <option value="">请选择门店</option>
                      <option value="store1">朝阳店</option>
                      <option value="store2">海淀店</option>
                      <option value="store3">西城店</option>
                    </select>
                  </div>

                  <div class="form-item">
                    <label class="form-label">自提时间</label>
                    <select id="pickupTime" class="form-select">
                      <option value="">请选择时间</option>
                      <option value="morning">上午 9:00-12:00</option>
                      <option value="afternoon">下午 14:00-18:00</option>
                      <option value="evening">晚上 18:00-21:00</option>
                    </select>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- 支付信息组 -->
      <div class="form-group" id="group-payment">
        <div class="form-group-header" onclick="toggleGroup('payment')">
          <div class="form-group-title">
            <span class="form-group-icon">💳</span>
            <span>支付信息</span>
          </div>
          <span class="form-group-arrow">▶</span>
        </div>
        <div class="form-group-body">
          <div class="form-group-content">
            <div class="form-item">
              <label class="form-label">支付方式</label>
              <select id="paymentMethod" class="form-select">
                <option value="">请选择</option>
                <option value="alipay">支付宝</option>
                <option value="wechat">微信支付</option>
                <option value="card">银行卡</option>
              </select>
            </div>

            <!-- 银行卡支付相关字段 -->
            <div id="cardFields" style="display: none;">
              <div class="conditional-field">
                <div class="form-grid">
                  <div class="form-item">
                    <label class="form-label">卡号</label>
                    <input type="text" id="cardNumber" class="form-input" placeholder="请输入银行卡号" maxlength="19" />
                  </div>

                  <div class="form-item">
                    <label class="form-label">持卡人姓名</label>
                    <input type="text" id="cardHolder" class="form-input" placeholder="请输入持卡人姓名" />
                  </div>

                  <div class="form-item">
                    <label class="form-label">有效期</label>
                    <input type="text" id="cardExpiry" class="form-input" placeholder="MM/YY" maxlength="5" />
                  </div>

                  <div class="form-item">
                    <label class="form-label">CVV</label>
                    <input type="text" id="cardCVV" class="form-input" placeholder="***" maxlength="3" />
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- 操作按钮 -->
      <div class="form-actions">
        <button type="button" id="submitBtn" class="btn btn-primary">提交</button>
        <button type="button" id="resetBtn" class="btn">重置</button>
        <button type="button" class="btn" onclick="expandAll()">全部展开</button>
        <button type="button" class="btn" onclick="collapseAll()">全部收起</button>
      </div>
    </div>

    <!-- 显示收集的数据 -->
    <div class="section-card"
      style="background: #fff; padding: 24px; border-radius: 4px; box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);">
      <h3 style="margin-bottom: 16px;">📊 表单数据</h3>
      <pre id="formData"
        style="padding: 16px; background: #f5f5f5; border-radius: 4px; font-size: 13px; overflow-x: auto;">
未提交
      </pre>
    </div>
  </div>

  <script type="module">
    import { createForm } from '../src/core/form-core.js'

    // 表单数据
    const formData = {
      username: '',
      email: '',
      gender: '',
      hasJob: false,
      company: '',
      position: '',
      industry: '',
      otherIndustry: '',
      shippingMethod: '',
      receiverName: '',
      receiverPhone: '',
      receiverAddress: '',
      pickupStore: '',
      pickupTime: '',
      paymentMethod: '',
      cardNumber: '',
      cardHolder: '',
      cardExpiry: '',
      cardCVV: ''
    }

    // 创建表单
    const form = createForm({
      initialValues: formData,
      onSubmit: async (values) => {
        collectAllData()
        document.getElementById('formData').textContent = JSON.stringify(formData, null, 2)
        console.log('提交数据:', formData)
      }
    })

    // 分组展开/收起
    window.toggleGroup = (groupName) => {
      const group = document.getElementById(`group-${groupName}`)
      group.classList.toggle('expanded')
    }

    window.expandAll = () => {
      document.querySelectorAll('.form-group').forEach(group => {
        group.classList.add('expanded')
      })
    }

    window.collapseAll = () => {
      document.querySelectorAll('.form-group').forEach(group => {
        group.classList.remove('expanded')
      })
    }

    // 条件字段 - 是否有工作
    const hasJobSwitch = document.getElementById('hasJobSwitch')
    const jobFields = document.getElementById('jobFields')

    hasJobSwitch.addEventListener('click', function () {
      formData.hasJob = !formData.hasJob
      this.classList.toggle('checked', formData.hasJob)

      if (formData.hasJob) {
        jobFields.style.display = 'block'
      } else {
        jobFields.style.display = 'none'
        // 清空工作相关字段
        document.getElementById('company').value = ''
        document.getElementById('position').value = ''
        document.getElementById('industry').value = ''
        document.getElementById('otherIndustry').value = ''
        document.getElementById('otherIndustryField').style.display = 'none'
      }
    })

    // 二级条件字段 - 其他行业
    document.getElementById('industry').addEventListener('change', (e) => {
      const otherField = document.getElementById('otherIndustryField')

      if (e.target.value === 'other') {
        otherField.style.display = 'block'
      } else {
        otherField.style.display = 'none'
        document.getElementById('otherIndustry').value = ''
      }
    })

    // 条件字段 - 配送方式
    const shippingMethodSelect = document.getElementById('shippingMethod')
    const expressFields = document.getElementById('expressFields')
    const pickupFields = document.getElementById('pickupFields')

    shippingMethodSelect.addEventListener('change', (e) => {
      const method = e.target.value

      expressFields.style.display = 'none'
      pickupFields.style.display = 'none'

      if (method === 'express') {
        expressFields.style.display = 'block'
      } else if (method === 'pickup') {
        pickupFields.style.display = 'block'
      }

      // 清空未选中方式的字段
      if (method !== 'express') {
        document.getElementById('receiverName').value = ''
        document.getElementById('receiverPhone').value = ''
        document.getElementById('receiverAddress').value = ''
      }
      if (method !== 'pickup') {
        document.getElementById('pickupStore').value = ''
        document.getElementById('pickupTime').value = ''
      }
    })

    // 条件字段 - 支付方式
    const paymentMethodSelect = document.getElementById('paymentMethod')
    const cardFields = document.getElementById('cardFields')

    paymentMethodSelect.addEventListener('change', (e) => {
      const method = e.target.value

      if (method === 'card') {
        cardFields.style.display = 'block'
      } else {
        cardFields.style.display = 'none'
        // 清空银行卡字段
        document.getElementById('cardNumber').value = ''
        document.getElementById('cardHolder').value = ''
        document.getElementById('cardExpiry').value = ''
        document.getElementById('cardCVV').value = ''
      }
    })

    // 提交表单
    document.getElementById('submitBtn').addEventListener('click', async () => {
      await form.submit()
    })

    // 重置表单
    document.getElementById('resetBtn').addEventListener('click', () => {
      form.reset()

      // 重置所有输入
      document.querySelectorAll('.form-input, .form-select').forEach(el => {
        el.value = ''
      })

      // 重置开关
      hasJobSwitch.classList.remove('checked')
      formData.hasJob = false

      // 隐藏条件字段
      jobFields.style.display = 'none'
      expressFields.style.display = 'none'
      pickupFields.style.display = 'none'
      cardFields.style.display = 'none'
      document.getElementById('otherIndustryField').style.display = 'none'

      // 清空显示数据
      document.getElementById('formData').textContent = '未提交'

      console.log('表单已重置')
    })

    // 收集所有数据
    function collectAllData() {
      formData.username = document.getElementById('username').value
      formData.email = document.getElementById('email').value
      formData.gender = document.getElementById('gender').value
      formData.company = document.getElementById('company').value
      formData.position = document.getElementById('position').value
      formData.industry = document.getElementById('industry').value
      formData.otherIndustry = document.getElementById('otherIndustry').value
      formData.shippingMethod = document.getElementById('shippingMethod').value
      formData.receiverName = document.getElementById('receiverName').value
      formData.receiverPhone = document.getElementById('receiverPhone').value
      formData.receiverAddress = document.getElementById('receiverAddress').value
      formData.pickupStore = document.getElementById('pickupStore').value
      formData.pickupTime = document.getElementById('pickupTime').value
      formData.paymentMethod = document.getElementById('paymentMethod').value
      formData.cardNumber = document.getElementById('cardNumber').value
      formData.cardHolder = document.getElementById('cardHolder').value
      formData.cardExpiry = document.getElementById('cardExpiry').value
      formData.cardCVV = document.getElementById('cardCVV').value
    }

    console.log('🎯 条件字段和表单分组演示已加载')
  </script>
</body>

</html>


